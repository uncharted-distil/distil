<template>
  <b-modal id="settings" title="Model Creation Settings" @ok="handleOk">
    <b-form-group
      id="model-limit"
      label="Maximum Generated Models:"
      label-for="num-models-spinner"
      description="Limits the number of models generated by the search process."
    >
      <b-form-spinbutton
        id="model-limit-spinner"
        inline
        v-model="modelLimit"
        min="1"
        max="100"
      />
    </b-form-group>
    <b-form-group
      id="time-limit"
      label="Time Limit:"
      label-for="time-limit-spinner"
      description="Sets that maximum allowed model search time in minutes."
    >
      <b-form-spinbutton
        id="time-limit-spinner"
        inline
        v-model="timeLimit"
        min="1"
        max="240"
      />
    </b-form-group>
    <b-form-group
      label="Model Training:"
      label-for="model-training-ratios"
      description="Selects faster model training or higher quality models."
    >
      <b-form-radio
        v-model="speedQuality"
        name="model-training-radios"
        value="speed"
        >Faster
      </b-form-radio>
      <b-form-radio
        v-model="speedQuality"
        name="model-training-radios"
        value="quality"
        >Higher Quality
      </b-form-radio>
    </b-form-group>
  </b-modal>
</template>

<script lang="ts">
import _ from "lodash";
import Vue from "vue";
import { ModelQuality } from "../store/requests";
import { overlayRouteEntry } from "../util/routes";
import { getters as routeGetters } from "../store/route/module";

// Dialog for setting model creation preferences.  The results are saved to the route to ensure
// that users don't have to set them for each run.
export default Vue.extend({
  name: "settings-modal",

  data() {
    return {
      modelLimit: routeGetters.getModelLimit(this.$store) || 5,
      timeLimit: routeGetters.getModelTimeLimit(this.$store) || 5,
      speedQuality:
        routeGetters.getModelQuality(this.$store) ||
        ModelQuality.HIGHER_QUALITY,
    };
  },

  computed: {},

  props: {},

  methods: {
    handleOk() {
      const entry = overlayRouteEntry(routeGetters.getRoute(this.$store), {
        modelLimit: this.modelLimit,
        modelTimeLimit: this.timeLimit,
        modelQuality: this.speedQuality,
      });
      this.$router.push(entry).catch((err) => console.warn(err));
    },
  },
});
</script>

<style></style>
