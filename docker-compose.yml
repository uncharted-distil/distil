elastic:
  image:
    registry.datadrivendiscovery.org/ta3-submissions/ta2-uncharted/summer2019/distil_dev_es:latest
  ports:
    - "9200:9200"

# pipeline_server:
#   image:
#     docker.uncharted.software/distil-pipeline-server:latest
#   ports:
#     - "45042:45042"
#   environment:
#     - SOLUTION_SERVER_RESULT_DIR=/home/chris/temp/outputs
#     - SOLUTION_SEND_DELAY=2000
#     - SOLUTION_NUM_UPDATES=3
#     - SOLUTION_MAX_SOLUTIONS=3
#     - SOLUTION_ERR_PERCENT=0.1
#   volumes:
#     - /home/chris/data/d3m:/home/chris/data/d3m
#     - $PWD/datamart:$PWD/datamart
#     - /home/chris/temp/outputs:/home/chris/temp/outputs

postgres:
  image:
    registry.datadrivendiscovery.org/ta3-submissions/ta2-uncharted/summer2019/distil_dev_postgres:latest
  ports:
    - "5432:5432"
  command:
    -d postgres

distil-auto-ml:
  image:
    registry.datadrivendiscovery.org/uncharted/distil-integration/distil-auto-ml:latest
  environment:
    - D3MINPUTDIR=$D3MINPUTDIR
    - D3MOUTPUTDIR=$D3MOUTPUTDIR
    - D3MSTATICDIR=$D3MSTATICDIR
    - D3MRUN=ta2
  volumes:
    - $D3MOUTPUTDIR:$D3MOUTPUTDIR
    - $D3MINPUTDIR:$D3MINPUTDIR
    - $D3MSTATICDIR:$D3MSTATICDIR
  ports:
    - "45042:45042"

runner:
  image:
    docker.uncharted.software/distil-pipeline-runner:latest
  ports:
    - "50051:50051"
  environment:
    - D3MOUTPUTDIR=$D3MOUTPUTDIR
    - VERBOSE_PRIMITIVE_OUTPUT=1
    - D3MSTATICDIR=$D3MSTATICDIR
  volumes:
    - $D3MOUTPUTDIR:$D3MOUTPUTDIR
    - $D3MINPUTDIR:$D3MINPUTDIR
    - $D3MSTATICDIR:$D3MSTATICDIR
